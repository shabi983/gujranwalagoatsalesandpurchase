<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Gujranwala Goats Sales and Purchase - Admin Panel</title>
<link rel="icon" href="https://res.cloudinary.com/dn2kaltwg/image/upload/v1758995211/hseoh5jiurx1gyh9b7x7.jpg">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="">

       <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


<div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="index.html">Home</a>
  <a href="goats.html">Available Goats</a>
  <a href="about.html">About</a>
  <a href="contact.html">Contact</a>
  <a href="" onclick="logout()" style="background: red;">Logout</a>
</div>

<div style="padding:20px; display: flex; justify-content: space-around; font-size:30px;cursor:pointer; color: #ffffff; position: sticky; left: 5px; top: 0; z-index:9000; background:#000;" onclick="openNav()">&#9776; Menu <img width="60px" style="border-radius:45%" src="https://res.cloudinary.com/dn2kaltwg/image/upload/v1758995211/hseoh5jiurx1gyh9b7x7.jpg" /></div>

<script>
function openNav() {
  document.getElementById("mySidenav").style.width = "250px";
}

function closeNav() {
  document.getElementById("mySidenav").style.width = "0";
}
</script>




<section id="home" class="home">
      <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
  <ol class="carousel-indicators">
    <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
    <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
    <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
  </ol>
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="https://media.scbt.com/en/s/scah-goat-landing.png" class="d-block w-100" alt="...">
      <div style="background: #000000c4;" class="carousel-caption d-none d-md-block">
        <h5>Looking for End-to-End Support with your projects?</h5>
        <p>Nulla vitae elit libero, a pharetra augue mollis interdum.</p>
      </div>
    </div>
    <div class="carousel-item">
      <img src="https://kashigoatfarm.weebly.com/uploads/1/1/2/8/112872465/editor/banner02_1.jpg" class="d-block w-100" alt="...">
      <div style="background: #000000c4;" class="carousel-caption d-none d-md-block">
        <h5>Second slide label</h5>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
      </div>
    </div>
    <div class="carousel-item">
      <img src="https://cdn.pixabay.com/photo/2017/09/05/22/35/goats-2719445_1280.jpg" class="d-block w-100" alt="...">
      <div style="background: #000000c4;" class="carousel-caption d-none d-md-block">
        <h5>Third slide label</h5>
        <p>Praesent commodo cursus magna, vel scelerisque nisl consectetur.</p>
      </div>
    </div>
  </div>
  <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>
  </section>
<div id="usersSection" class="p-4 border mb-6">
  <h2 class="text-xl font-bold mb-2">Manage Users</h2>
  <div style="overflow-x: scroll;">
  <table id="usersTable" class="w-full border">
    <thead>
      <tr class="bg-gray-200">
        <th class="p-2">Name</th>
        <th class="p-2">Email</th>
        <th class="p-2">Role</th>
        <th class="p-2">Actions</th>
      </tr>
    </thead>
    <tbody style="text-align: center;"></tbody>
  </table></div>
</div>

<style>
  #lightbox.hidden {
  display: none;
}

#lightbox img {
  cursor: zoom-out;
  transition: transform 0.3s ease;
}

#lightbox img:hover {
  transform: scale(1.05);
}

/* Grid container */
.goat-grid {
  display: grid;
  gap: 16px; /* space between columns and rows */
  grid-template-columns: repeat(3, 1fr); /* 3 columns by default */
  padding: 40px;
}

/* Each goat section scrollable if content exceeds 400px */
.goat-section {
  border: 1px solid #ccc;
  padding: 16px;
  max-height: 400px;
  overflow-y: auto;
  border-radius: 8px;
}

.logoutA{
position: fixed; top: 20px; right: 0; padding: 10px; background: #000000; color: #ffffff; text-decoration: none; font-weight: bolder;  border-radius: 10px 0px 0px 10px;
}

.logoutA:hover{
  background:darkred;
  transition: 0.3s;
}


.sidenav {
  height: 100%;
  width: 0;
  position: fixed;
  z-index: 10000;
  top: 0;
  left: 0;
  background-color: #111;
  overflow-x: hidden;
  transition: 0.5s;
  padding-top: 60px;
}

.sidenav a {
  padding: 8px 8px 8px 32px;
  text-decoration: none;
  font-size: 25px;
  color: #818181;
  display: block;
  transition: 0.3s;
}

.sidenav a:hover {
  color: #f1f1f1;
}

.sidenav .closebtn {
  position: absolute;
  top: 0;
  right: 25px;
  font-size: 36px;
  margin-left: 50px;
}

/* Tablet: 2 columns */
@media (max-width: 1024px) {
  .goat-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Mobile: 1 column */
@media (max-width: 640px) {
  .goat-grid {
    grid-template-columns: 1fr;
  }
}

</style>

<!-- Edit User Modal -->
<div style="z-index: 99999;" id="editUserModal" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white p-6 rounded shadow-lg w-96">
    <h3 class="text-lg font-bold mb-4">Edit User</h3>
    <input type="hidden" id="editUserId">
    <input id="editUserName" class="w-full border p-2 mb-2" placeholder="Name">
    <input id="editUserEmail" class="w-full border p-2 mb-2" placeholder="Email">
    <select id="editUserRole" class="w-full border p-2 mb-4">
      <option value="user">User</option>
      <option value="admin">Admin</option>
    </select>
    <button onclick="saveUser()" class="bg-green-500 text-white px-4 py-2 rounded">Save</button>
    <button onclick="closeUserModal()" class="ml-2 bg-gray-400 text-white px-4 py-2 rounded">Cancel</button>
  </div>
</div>

<div class="goat-grid">
  <!-- Pending Goats -->
  <div id="pendingGoats" class="goat-section">
    <h2 class="text-lg font-bold mb-2" style="position: sticky; top: 0; background: #ffffff; z-index: 1000;">üêê Pending Goats</h2>
    <div id="pendingList"></div>
  </div>

  <!-- Approved Goats -->
  <div id="approvedGoats" class="goat-section">
    <h2 class="text-lg font-bold mb-2" style="position: sticky; top: 0; background: #ffffff; z-index: 1000;">‚úÖ Approved Goats</h2>
    <div id="approvedList"></div>
  </div>

  <!-- Rejected Goats -->
  <div id="rejectedGoats" class="goat-section">
    <h2 class="text-lg font-bold mb-2" style="position: sticky; top: 0; background: #ffffff; z-index: 1000;">‚ùå Rejected Goats</h2>
    <div id="rejectedList"></div>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwEs3eFUs7MlxdZ4FQPFFx6g2EFCc9dklhhkxt66qSPmpXVyOFUBS33nA4_ipam35ENbA/exec"; // replace

document.addEventListener("DOMContentLoaded", () => {
  if (localStorage.getItem("role") !== "admin") {
    alert("Only admin has access!");
    window.location.href = "login.html";
    return;
  }
  loadUsers();
  loadGoats();
});

function logout() {
  localStorage.clear();
  window.location.href = "login.html";
}

// === USERS ===
async function loadUsers() {
  let res = await fetch(SCRIPT_URL, {
    method: "POST",
    body: new URLSearchParams({ action: "getUsers" })
  });
  let users = await res.json();
  const tbody = document.querySelector("#usersTable tbody");
  tbody.innerHTML = "";
  users.forEach(u => {
    tbody.innerHTML += `
      <tr class="border-b">
        <td class="p-2">${u.name}</td>
        <td class="p-2">${u.email}</td>
        <td class="p-2">${u.role}</td>
        <td class="p-2">
          <button onclick="editUser('${u.id}','${u.name}','${u.email}','${u.role}')" class="bg-blue-500 text-white px-2 py-1 rounded">Edit</button>
          <button onclick="deleteUser('${u.id}')" class="bg-red-500 text-white px-2 py-1 rounded">Delete</button>
        </td>
      </tr>
    `;
  });
}

function editUser(id,name,email,role){
  document.getElementById("editUserId").value = id;
  document.getElementById("editUserName").value = name;
  document.getElementById("editUserEmail").value = email;
  document.getElementById("editUserRole").value = role;
  document.getElementById("editUserModal").classList.remove("hidden");
}

function closeUserModal() {
  document.getElementById("editUserModal").classList.add("hidden");
}

async function saveUser(){
  const id = document.getElementById("editUserId").value;
  const name = document.getElementById("editUserName").value;
  const email = document.getElementById("editUserEmail").value;
  const role = document.getElementById("editUserRole").value;

  await fetch(SCRIPT_URL, {
    method:"POST",
    body: new URLSearchParams({ action:"updateUser", id, name, email, role })
  });

  closeUserModal();
  loadUsers();
}

async function deleteUser(id){
  if(!confirm("Delete this user?")) return;
  await fetch(SCRIPT_URL, {
    method:"POST",
    body: new URLSearchParams({ action:"deleteUser", id })
  });
  loadUsers();
}

// === GOATS ===
async function loadGoats() {
  try {
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      body: new URLSearchParams({
        action: "getGoats",
        role: "admin"
      })
    });
    const goats = await res.json();
    console.log("Goats fetched:", goats);

    // Clear lists
    document.getElementById("pendingList").innerHTML = "";
    document.getElementById("approvedList").innerHTML = "";
    document.getElementById("rejectedList").innerHTML = "";

    goats.forEach(goat => {
      const div = document.createElement("div");
      div.className = "goat-card border p-2 mb-2 rounded";

      div.innerHTML = `
        <h3 class="font-bold">${goat.title}</h3>
        <p>${goat.desc}</p>
        <p>Price: ${goat.price} PKR</p>
        <p>Status: ${goat.status}</p>
      `;

      // Buttons
      const approveBtn = document.createElement("button");
      approveBtn.innerText = "Approve";
      approveBtn.onclick = () => updateStatus(goat.id, "Approved");
      approveBtn.className = "bg-green-500 text-white px-2 py-1 rounded mr-1";

      const rejectBtn = document.createElement("button");
      rejectBtn.innerText = "Reject";
      rejectBtn.onclick = () => updateStatus(goat.id, "Rejected");
      rejectBtn.className = "bg-red-500 text-white px-2 py-1 rounded mr-1";

      const pendingBtn = document.createElement("button");
      pendingBtn.innerText = "Pending";
      pendingBtn.onclick = () => updateStatus(goat.id, "Pending");
      pendingBtn.className = "bg-yellow-500 text-white px-2 py-1 rounded";

      div.appendChild(document.createElement("br"));
      div.appendChild(approveBtn);
      div.appendChild(rejectBtn);
      div.appendChild(pendingBtn);

      // Photos slider
      const photos = Array.isArray(goat.photos) ? goat.photos : [];
      if (photos.length > 0) {
        const sliderContainer = document.createElement("div");
        sliderContainer.className = "goat-gallery relative w-full h-48 overflow-hidden mt-2 rounded";

        const slides = document.createElement("div");
        slides.className = "goat-slides flex transition-transform duration-300";

        photos.forEach(url => {
          const img = document.createElement("img");
          img.src = url;
          img.className = "w-full h-48 object-cover flex-shrink-0";
          slides.appendChild(img);
        });

        sliderContainer.appendChild(slides);


        if (photos.length > 1) {
          let index = 0;
          const prevBtn = document.createElement("button");
          prevBtn.innerText = "‚Äπ";
          prevBtn.className = "prev absolute top-1/2 left-2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white px-2 py-1 rounded";
          const nextBtn = document.createElement("button");
          nextBtn.innerText = "‚Ä∫";
          nextBtn.className = "next absolute top-1/2 right-2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white px-2 py-1 rounded";

          sliderContainer.appendChild(prevBtn);
          sliderContainer.appendChild(nextBtn);

          prevBtn.addEventListener("click", () => {
            index = (index - 1 + photos.length) % photos.length;
            slides.style.transform = `translateX(-${index * 100}%)`;
          });

          nextBtn.addEventListener("click", () => {
            index = (index + 1) % photos.length;
            slides.style.transform = `translateX(-${index * 100}%)`;
          });
        }


        div.appendChild(sliderContainer);
      }

      // Append to container based on status
      let container;
      if (goat.status.toLowerCase() === "pending") container = document.getElementById("pendingList");
      else if (goat.status.toLowerCase() === "approved") container = document.getElementById("approvedList");
      else if (goat.status.toLowerCase() === "rejected") container = document.getElementById("rejectedList");

      if (container) container.appendChild(div);
    });

  } catch (err) {
    console.error("Error loading goats:", err);
  }
}

document.addEventListener("DOMContentLoaded", () => {
  let currentPhotos = [];
  let currentIndex = 0;

  const lightbox = document.getElementById("lightbox");
  const lightboxImg = document.getElementById("lightboxImg");
  const closeBtn = document.getElementById("lightboxClose");
  const prevBtn = document.getElementById("lightboxPrev");
  const nextBtn = document.getElementById("lightboxNext");

  // Open lightbox when a goat photo is clicked
  document.addEventListener("click", function(e) {
    if (e.target.tagName === "IMG" && e.target.closest(".goat-gallery")) {
      const gallery = e.target.closest(".goat-gallery");
      currentPhotos = Array.from(gallery.querySelectorAll("img")).map(img => img.src);
      currentIndex = currentPhotos.indexOf(e.target.src);

      lightboxImg.src = currentPhotos[currentIndex];
      lightbox.classList.remove("hidden");
    }
  });

  // Close button
  closeBtn.addEventListener("click", () => {
    lightbox.classList.add("hidden");
  });

  // Previous photo
  prevBtn.addEventListener("click", () => {
    if (currentPhotos.length === 0) return;
    currentIndex = (currentIndex - 1 + currentPhotos.length) % currentPhotos.length;
    lightboxImg.src = currentPhotos[currentIndex];
  });

  // Next photo
  nextBtn.addEventListener("click", () => {
    if (currentPhotos.length === 0) return;
    currentIndex = (currentIndex + 1) % currentPhotos.length;
    lightboxImg.src = currentPhotos[currentIndex];
  });

  // Close if clicking outside the image
  lightbox.addEventListener("click", function(e) {
    if (e.target === lightbox) {
      lightbox.classList.add("hidden");
    }
  });
});



async function updateStatus(id,status){
  await fetch(SCRIPT_URL, {
    method:"POST",
    body:new URLSearchParams({ action:"updateStatus", id, status })
  });
  loadGoats();
}
</script>


<!-- Fullscreen Lightbox Slider -->
<div id="lightbox" class="hidden fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50">
  <span id="lightboxClose" class="absolute top-4 right-6 text-white text-3xl cursor-pointer">&times;</span>
  
  <button id="lightboxPrev" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-white text-4xl cursor-pointer">‚Äπ</button>
  <img id="lightboxImg" src="" class="max-h-full max-w-full object-contain">
  <button id="lightboxNext" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-white text-4xl cursor-pointer">‚Ä∫</button>
</div>

<hr class="mt-5">
  <!-- Footer -->
<footer class="page-footer font-small unique-color-dark">
  <!-- Footer Links -->
  <div class="container text-center text-md-left mt-5">

    <!-- Grid row -->
    <div class="row mt-3">

      <!-- Grid column -->
      <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">

        <!-- Content -->
        <h5 class="text-uppercase"><img src="https://res.cloudinary.com/dn2kaltwg/image/upload/v1758995211/hseoh5jiurx1gyh9b7x7.jpg" style="max-width:70px; border-radius: 45%;" class="img-responsive"></h5>
       
        <p>At Gujranwala Goats Sales and Purchase, we believe that raising and trading goats is not just a business‚Äîit‚Äôs a passion built on trust, knowledge, and care. Founded and managed by Usman Aziz, our platform is dedicated to providing the healthiest and finest goats in the region. </p>

      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">

        <!-- Links -->
        <h6 class="text-uppercase font-weight-bold">Products</h6>
        <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
        <p>
          <a href="goats.html">Goats</a>
        </p>
        <p>
          <a href="#!">Products</a>
        </p>
        <p>
          <a href="about.html">About Us</a>
        </p>
        <p>
          <a href="contact.html">Contact us</a>
        </p>

      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">

        <!-- Links -->
        <h6 class="text-uppercase font-weight-bold">Useful links</h6>
        <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
        <p>
          <a href="login.html">Your Account</a>
        </p>
        <p>
          <a href="#!">Become an Affiliate</a>
        </p>
        <p>
          <a href="#!">Shipping Rates</a>
        </p>
        <p>
          <a href="https://wa.me/923556614953" target="_blank">Help</a>
        </p>

      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">

        <!-- Links -->
        <h6 class="text-uppercase font-weight-bold">Contact</h6>
        <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="max-width: 100%;">
        <p>
          <i class="fa fa-home mr-3"></i>  Gujranwala Cantt, Punjab , Pakistan.</p>
        <p>
          <i class="fa fa-envelope mr-3"></i> sulemanaziz405@gmail.com</p>
        <p>
          <i class="fa fa-phone mr-3"></i> +92 355 661-4953</p>
        <p>
          <i class="fa fa-print mr-3"></i> +92 320 716-1215</p>

      </div>
      <!-- Grid column -->

    </div>
    <!-- Grid row -->

  </div>
  <!-- Footer Links -->
<hr>
  <!-- Copyright -->
  <div class="footer-copyright text-center py-3">¬© 2025 Copyright:
    <a href="#"> Gujranwala Goats Sales & Purchase</a>
  </div>
  <!-- Copyright -->

</footer>
<!-- Footer -->


</body>
</html>

